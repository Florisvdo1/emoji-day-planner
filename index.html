<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Emoji Day Planner</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Styles -->
    <style>
        /* Global Styles */
        body {
            margin: 0;
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
            transition: background-color 0.3s, color 0.3s;
            background-color: #ffffff;
            color: #000000;
            overflow: hidden; /* Prevents extra scrollbars */
        }
        .dark-mode {
            background-color: #121212;
            color: #ffffff;
        }
        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background-color: #fff;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .dark-mode .header {
            background-color: #1e1e1e;
        }
        /* Clock Display */
        .clock-display {
            display: flex;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
        }
        .clock-icon {
            margin-right: 8px;
            font-size: 28px;
        }
        /* Sticky Button */
        .sticky-button {
            background-color: #007bff;
            color: #fff;
            border: 6px solid #ffd700; /* Yellow border */
            border-radius: 12px;
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 123, 255, 0.3);
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        .sticky-button:hover {
            background-color: #0056b3;
        }
        .dark-mode .sticky-button {
            background-color: #0056b3;
        }
        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            top: 15px;
            right: 70px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            font-size: 28px;
            outline: none;
            z-index: 1001;
        }
        /* Planner Grid */
        .planner {
            position: absolute;
            top: 70px; /* Adjusted for header height */
            bottom: 0;
            left: 0;
            right: 0;
            overflow-y: auto;
            display: grid;
            grid-template-columns: 1fr;
            grid-auto-rows: 80px;
            padding-bottom: 100px; /* Space for buttons */
        }
        .time-slot {
            border-bottom: 1px solid #ccc;
            position: relative;
            padding-left: 60px;
            box-sizing: border-box;
            background: linear-gradient(135deg, #2a3d66, #3b5998); /* Mid dark blue to light blue gradient */
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
            background-size: cover;
        }
        .dark-mode .time-slot {
            background: linear-gradient(135deg, #1a2a4a, #2b3a6a);
        }
        .time-label {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 14px;
            font-weight: bold;
            color: #ffffff;
        }
        .emoji-container {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            margin-top: 10px;
            margin-left: -5px;
        }
        .emoji {
            font-size: 32px;
            cursor: move;
            margin: 5px;
            transition: transform 0.2s;
        }
        .emoji.dragging {
            transform: scale(1.1);
            opacity: 0.7;
        }
        /* Add Task Button */
        .add-task-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            font-size: 30px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            cursor: pointer;
            outline: none;
            box-shadow: 0 4px 6px rgba(0, 123, 255, 0.3);
            z-index: 1000;
        }
        .dark-mode .add-task-btn {
            background-color: #0056b3;
        }
        /* Undo Button */
        .undo-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            font-size: 28px;
            background-color: #28a745;
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            cursor: pointer;
            outline: none;
            box-shadow: 0 4px 6px rgba(40, 167, 69, 0.3);
            z-index: 1000;
        }
        /* Emoji Palette */
        .emoji-palette {
            display: flex;
            flex-direction: column;
            padding: 10px;
            background-color: #f0f0f0;
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 320px;
            max-height: 400px;
            overflow-y: auto;
            border: 2px solid #ccc;
            border-radius: 10px;
            z-index: 1000;
        }
        .dark-mode .emoji-palette {
            background-color: #222222;
            color: #ffffff;
            border-color: #444444;
        }
        .emoji-palette .category {
            margin-bottom: 10px;
        }
        .emoji-palette .category-title {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 16px;
        }
        .emoji-palette .emoji-option {
            font-size: 28px;
            margin: 5px;
            cursor: pointer;
            display: inline-block;
        }
        .hidden {
            display: none;
        }
        /* Responsive Design */
        @media (min-width: 600px) {
            .planner {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        @media (min-width: 900px) {
            .planner {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        /* iPhone Specific Styles */
        @media screen and (device-width: 375px) and (device-height: 812px) {
            /* iPhone X, XS */
            .planner {
                padding-bottom: 120px; /* Account for notch */
            }
        }
        @media screen and (device-width: 390px) and (device-height: 844px) {
            /* iPhone 12, 12 Pro */
            .planner {
                padding-bottom: 120px;
            }
        }
        @media screen and (device-width: 428px) and (device-height: 926px) {
            /* iPhone 12 Pro Max, 13 Pro Max */
            .planner {
                padding-bottom: 120px;
            }
        }
    </style>
</head>
<body>
    <!-- Header with Clock and Sticky Button -->
    <div class="header">
        <!-- Clock Display -->
        <div class="clock-display" id="clockDisplay">
            <div class="clock-icon">üïí</div>
            <div id="currentTime">Loading...</div>
        </div>
        <!-- Sticky Button -->
        <a href="#" class="sticky-button" id="stickyButton">Plan My Day</a>
    </div>

    <!-- Theme Toggle -->
    <button class="theme-toggle" id="themeToggle">üåì</button>

    <!-- Planner Grid -->
    <div class="planner" id="planner">
        <!-- Time Slots will be generated here -->
    </div>

    <!-- Add Task Button -->
    <button class="add-task-btn" id="addTaskBtn">+</button>

    <!-- Undo Button -->
    <button class="undo-btn" id="undoBtn">‚Ü©Ô∏è</button>

    <!-- Emoji Palette -->
    <div class="emoji-palette hidden" id="emojiPalette">
        <!-- Emojis will be populated here -->
    </div>

    <!-- Scripts -->
    <script>
        // Clock Display
        function updateTime() {
            const clockDisplay = document.getElementById('currentTime');
            const now = new Date();
            // Convert to Amsterdam time
            const amsterdamTime = new Date(now.toLocaleString("en-US", { timeZone: "Europe/Amsterdam" }));
            const hours = amsterdamTime.getHours().toString().padStart(2, '0');
            const minutes = amsterdamTime.getMinutes().toString().padStart(2, '0');
            const seconds = amsterdamTime.getSeconds().toString().padStart(2, '0');
            clockDisplay.textContent = `${hours}:${minutes}:${seconds}`;
        }
        setInterval(updateTime, 1000);
        updateTime();

        // Planner Initialization
        const planner = document.getElementById('planner');
        const timeSlots = [
            '07:00', '08:00', '09:00', '10:00', '11:00', '12:00',
            '13:00', '14:00', '15:00', '16:00', '17:00', '18:00',
            '19:00', '20:00', '21:00', '22:00', '23:00', '23:59'
        ];
        timeSlots.forEach(time => {
            const slot = document.createElement('div');
            slot.className = 'time-slot';
            slot.dataset.time = time;
            slot.ondragover = allowDrop;
            slot.ondrop = drop;
            const label = document.createElement('div');
            label.className = 'time-label';
            label.textContent = time;
            slot.appendChild(label);
            const emojiContainer = document.createElement('div');
            emojiContainer.className = 'emoji-container';
            slot.appendChild(emojiContainer);
            planner.appendChild(slot);
        });

        // Emoji Palette
        const emojiPalette = document.getElementById('emojiPalette');
        const emojiCategories = {
            'Smileys & Emotion': ['üòÄ','üòÉ','üòÑ','üòÅ','üòÜ','üòÖ','üòÇ','ü§£','üòä','üòá','üôÇ','üôÉ','üòâ','üòå','üòç','ü•∞','üòò','üòó','üòô','üòö','üòã','üòõ','üòú','ü§™','üòù','ü§ë','ü§ó','ü§≠','ü§´','ü§î','ü§ê','üòê','üòë','üò∂','üòè','üòí','üôÑ','üò¨','ü§•','üòå','üòî','üò™','ü§§','üò¥','üò∑','ü§í','ü§ï','ü§¢','ü§Æ','ü§ß','ü•µ','ü•∂','ü•¥','üòµ','ü§Ø','ü§†','ü•≥','üòé','ü§ì','üßê','üòï','üòü','üôÅ','‚òπÔ∏è','üòÆ','üòØ','üò≤','üò≥','ü•∫','üò¶','üòß','üò®','üò∞','üò•','üò¢','üò≠','üò±','üòñ','üò£','üòû','üòì','üò©','üò´','üò§','üò°','üò†','ü§¨','üòà','üëø','üíÄ','‚ò†Ô∏è','üí©','ü§°','üëπ','üë∫','üëª','üëΩ','üëæ','ü§ñ','üéÉ'],
            'People & Body': ['üë∂','üßí','üë¶','üëß','üßë','üë±‚Äç‚ôÇÔ∏è','üë±‚Äç‚ôÄÔ∏è','üë®','üßî','üë©','üë®‚Äçü¶∞','üë©‚Äçü¶∞','üë®‚Äçü¶±','üë©‚Äçü¶±','üë®‚Äçü¶≥','üë©‚Äçü¶≥','üë®‚Äçü¶≤','üë©‚Äçü¶≤','üë±','üë®‚Äç‚öïÔ∏è','üë©‚Äç‚öïÔ∏è','üë®‚Äçüéì','üë©‚Äçüéì','üë®‚Äçüè´','üë©‚Äçüè´','üë®‚Äç‚öñÔ∏è','üë©‚Äç‚öñÔ∏è','üë®‚Äçüåæ','üë©‚Äçüåæ','üë®‚Äçüç≥','üë©‚Äçüç≥','üë®‚Äçüîß','üë©‚Äçüîß','üë®‚Äçüè≠','üë©‚Äçüè≠','üë®‚Äçüíº','üë©‚Äçüíº','üë®‚Äçüî¨','üë©‚Äçüî¨','üë®‚Äçüíª','üë©‚Äçüíª','üë®‚Äçüé§','üë©‚Äçüé§','üë®‚Äçüé®','üë©‚Äçüé®','üë®‚Äç‚úàÔ∏è','üë©‚Äç‚úàÔ∏è','üë®‚ÄçüöÄ','üë©‚ÄçüöÄ','üë®‚Äçüöí','üë©‚Äçüöí','üëÆ','üëÆ‚Äç‚ôÇÔ∏è','üëÆ‚Äç‚ôÄÔ∏è','üïµÔ∏è','üïµÔ∏è‚Äç‚ôÇÔ∏è','üïµÔ∏è‚Äç‚ôÄÔ∏è','üíÇ','üíÇ‚Äç‚ôÇÔ∏è','üíÇ‚Äç‚ôÄÔ∏è','üë∑','üë∑‚Äç‚ôÇÔ∏è','üë∑‚Äç‚ôÄÔ∏è','ü§¥','üë∏','üë≥','üë≥‚Äç‚ôÇÔ∏è','üë≥‚Äç‚ôÄÔ∏è','üë≤','üßï','ü§µ','üë∞','ü§∞','ü§±','üë©‚Äçüçº','üë®‚Äçüçº','üßë‚Äçüçº','üëº','üéÖ','ü§∂','üßë‚ÄçüéÑ','ü¶∏','ü¶∏‚Äç‚ôÇÔ∏è','ü¶∏‚Äç‚ôÄÔ∏è','ü¶π','ü¶π‚Äç‚ôÇÔ∏è','ü¶π‚Äç‚ôÄÔ∏è','üßô','üßô‚Äç‚ôÇÔ∏è','üßô‚Äç‚ôÄÔ∏è','üßö','üßö‚Äç‚ôÇÔ∏è','üßö‚Äç‚ôÄÔ∏è','üßõ','üßõ‚Äç‚ôÇÔ∏è','üßõ‚Äç‚ôÄÔ∏è','üßú','üßú‚Äç‚ôÇÔ∏è','üßú‚Äç‚ôÄÔ∏è','üßù','üßù‚Äç‚ôÇÔ∏è','üßù‚Äç‚ôÄÔ∏è','üßû','üßû‚Äç‚ôÇÔ∏è','üßû‚Äç‚ôÄÔ∏è','üßü','üßü‚Äç‚ôÇÔ∏è','üßü‚Äç‚ôÄÔ∏è','üíÜ','üíÜ‚Äç‚ôÇÔ∏è','üíÜ‚Äç‚ôÄÔ∏è','üíá','üíá‚Äç‚ôÇÔ∏è','üíá‚Äç‚ôÄÔ∏è','üö∂','üö∂‚Äç‚ôÇÔ∏è','üö∂‚Äç‚ôÄÔ∏è','üßç','üßç‚Äç‚ôÇÔ∏è','üßç‚Äç‚ôÄÔ∏è','üßé','üßé‚Äç‚ôÇÔ∏è','üßé‚Äç‚ôÄÔ∏è','üßë‚Äçü¶Ø','üë®‚Äçü¶Ø','üë©‚Äçü¶Ø','üßë‚Äçü¶º','üë®‚Äçü¶º','üë©‚Äçü¶º','üßë‚Äçü¶Ω','üë®‚Äçü¶Ω','üë©‚Äçü¶Ω','üèÉ','üèÉ‚Äç‚ôÇÔ∏è','üèÉ‚Äç‚ôÄÔ∏è','üíÉ','üï∫','üï¥Ô∏è','üëØ','üëØ‚Äç‚ôÇÔ∏è','üëØ‚Äç‚ôÄÔ∏è','üßñ','üßñ‚Äç‚ôÇÔ∏è','üßñ‚Äç‚ôÄÔ∏è','üßò','üë≠','üë´','üë¨','üíè','üíë'],
            'Animals & Nature': ['üê∂','üê±','üê≠','üêπ','üê∞','ü¶ä','üêª','üêº','üê®','üêØ','ü¶Å','üêÆ','üê∑','üêΩ','üê∏','üêµ','üôà','üôâ','üôä','üêí','üêî','üêß','üê¶','üê§','üê£','üê•','ü¶Ü','ü¶Ö','ü¶â','ü¶á','üê∫','üêó','üê¥','ü¶Ñ','üêù','ü™±','üêõ','ü¶ã','üêå','üêû','üêú','ü¶ü','ü¶ó','üï∑Ô∏è','ü¶Ç','üê¢','üêç','ü¶é','ü¶ñ','ü¶ï','üêô','ü¶ë','ü¶ê','ü¶û','ü¶Ä','üê°','üê†','üêü','üê¨','üê≥','üêã','ü¶à','üêä','üêÖ','üêÜ','ü¶ì','ü¶ç','ü¶ß','üêò','ü¶õ','ü¶è','üê™','üê´','ü¶í','üêÉ','üêÇ','üêÑ','üêé','üêñ','üêè','üêë','üêê','ü¶å','üêï','üê©','üêà','üêì','ü¶É','ü¶ö','ü¶ú','ü¶¢','ü¶©','üïäÔ∏è','üêá','ü¶ù','ü¶®','ü¶°','ü¶¶','ü¶•','üêÅ','üêÄ','üêøÔ∏è','ü¶î','üêæ','üêâ','üê≤','üåµ','üéÑ','üå≤','üå≥','üå¥','üå±','üåø','‚òòÔ∏è','üçÄ','üéç','üéã','üçÉ','üçÇ','üçÅ','üçÑ','üêö','üåæ','üíê','üå∑','üåπ','ü•Ä','üå∫','üå∏','üåº','üåª','üåû','üåù','üåõ','üåú','üåö','üåï','üåñ','üåó','üåò','üåë','üåí','üåì','üåî','üåô','üåé','üåç','üåè','üí´','‚≠ê','üåü','‚ú®','‚ö°','üî•','üí•','‚òÑÔ∏è','‚òÄÔ∏è','üå§Ô∏è','‚õÖ','üå•Ô∏è','üå¶Ô∏è','üåà','‚òÅÔ∏è','üå©Ô∏è','üå®Ô∏è','üåßÔ∏è','‚ùÑÔ∏è','‚òÉÔ∏è','‚õÑ','üå¨Ô∏è','üí®','üå™Ô∏è','üå´Ô∏è','üåä','üíß','üí¶','‚òî'],
            'Food & Drink': ['üçè','üçé','üçê','üçä','üçã','üçå','üçâ','üçá','üçì','ü´ê','üçà','üçí','üçë','ü•≠','üçç','ü••','ü•ù','üçÖ','üçÜ','ü•ë','ü•¶','ü•¨','ü•í','üå∂Ô∏è','ü´ë','üåΩ','ü•ï','ü´í','üßÑ','üßÖ','ü•î','üç†','ü•ê','ü•Ø','üçû','ü•ñ','ü•®','üßÄ','ü•ö','üç≥','üßà','ü•û','üßá','ü•ì','ü•©','üçó','üçñ','ü¶¥','üå≠','üçî','üçü','üçï','ü•™','ü•ô','üßÜ','üåÆ','üåØ','ü•ó','ü•ò','ü´ï','üçù','üçú','üç≤','üçõ','üç£','üç±','ü•ü','ü¶™','üç§','üçô','üçö','üçò','üç•','ü•†','ü•Æ','üç¢','üç°','üçß','üç®','üç¶','ü•ß','üßÅ','üç∞','üéÇ','üçÆ','üç≠','üç¨','üç´','üçø','üßÇ','ü•§','üßã','üßÉ','üßâ','üçµ','‚òï','ü´ñ','üç∂','üç∫','üçª','ü•Ç','üç∑','ü•É','üç∏','üçπ','üßâ','üçæ','üßä','ü•Ñ','üç¥','ü•Ñ','üî™','ü´ï','üè∫'],
            'Travel & Places': ['üöó','üöï','üöô','üöå','üöé','üèéÔ∏è','üöì','üöë','üöí','üöê','üöö','üöõ','üöú','üõ∫','üö≤','üõ¥','üõπ','üõº','üõµ','üèçÔ∏è','üö®','üöî','üöç','üöò','üöñ','üö°','üö†','üöü','üöÉ','üöã','üöû','üöù','üöÑ','üöÖ','üöà','üöÇ','üöÜ','üöá','üöä','üöâ','‚úàÔ∏è','üõ´','üõ¨','üõ©Ô∏è','üí∫','üõ∞Ô∏è','üöÄ','üõ∏','üöÅ','üõ∂','‚õµ','üö§','üõ•Ô∏è','üõ≥Ô∏è','‚õ¥Ô∏è','üö¢','‚öì','ü™ù','‚õΩ','üöß','üö¶','üö•','üöè','üó∫Ô∏è','üóø','üóΩ','üóº','üè∞','üèØ','üèüÔ∏è','üé°','üé¢','üé†','‚õ≤','‚õ±Ô∏è','üèñÔ∏è','üèùÔ∏è','üèúÔ∏è','üåã','‚õ∞Ô∏è','üèîÔ∏è','üóª','üèïÔ∏è','‚õ∫','üõñ','üè†','üè°','üèòÔ∏è','üèöÔ∏è','üèóÔ∏è','üè≠','üè¢','üè¨','üè£','üè§','üè•','üè¶','üè®','üè™','üè´','üè©','üíí','üèõÔ∏è','‚õ™','üïå','üõï','üïç','‚õ©Ô∏è','üïã','‚õ≤','‚õ∫','üåÅ','üåÉ','üèôÔ∏è','üåÑ','üåÖ','üåÜ','üåá','üåâ','‚ô®Ô∏è','üåå','üéá','üéÜ','üå†','üéë','üåÑ','üåÖ'],
            'Activities': ['‚öΩ','üèÄ','üèà','‚öæ','üéæ','üèê','üèâ','ü•è','üé±','ü™Ä','üèì','üè∏','üèí','üèë','ü•ç','üèè','‚õ≥','ü™Å','üèπ','üé£','ü§ø','ü•ä','ü•ã','üéΩ','üõπ','üõº','üõ∑','‚õ∏Ô∏è','ü•å','üéø','‚õ∑Ô∏è','üèÇ','ü™Ç','üèãÔ∏è','üèãÔ∏è‚Äç‚ôÇÔ∏è','üèãÔ∏è‚Äç‚ôÄÔ∏è','ü§º','ü§º‚Äç‚ôÇÔ∏è','ü§º‚Äç‚ôÄÔ∏è','ü§∏','ü§∏‚Äç‚ôÇÔ∏è','ü§∏‚Äç‚ôÄÔ∏è','‚õπÔ∏è','‚õπÔ∏è‚Äç‚ôÇÔ∏è','‚õπÔ∏è‚Äç‚ôÄÔ∏è','ü§∫','ü§æ','ü§æ‚Äç‚ôÇÔ∏è','ü§æ‚Äç‚ôÄÔ∏è','üèåÔ∏è','üèåÔ∏è‚Äç‚ôÇÔ∏è','üèåÔ∏è‚Äç‚ôÄÔ∏è','üèá','üßò','üßò‚Äç‚ôÇÔ∏è','üßò‚Äç‚ôÄÔ∏è','üèÑ','üèÑ‚Äç‚ôÇÔ∏è','üèÑ‚Äç‚ôÄÔ∏è','üèä','üèä‚Äç‚ôÇÔ∏è','üèä‚Äç‚ôÄÔ∏è','ü§Ω','ü§Ω‚Äç‚ôÇÔ∏è','ü§Ω‚Äç‚ôÄÔ∏è','üö£','üö£‚Äç‚ôÇÔ∏è','üö£‚Äç‚ôÄÔ∏è','üßó','üßó‚Äç‚ôÇÔ∏è','üßó‚Äç‚ôÄÔ∏è','üöµ','üöµ‚Äç‚ôÇÔ∏è','üöµ‚Äç‚ôÄÔ∏è','üö¥','üö¥‚Äç‚ôÇÔ∏è','üö¥‚Äç‚ôÄÔ∏è','üèÜ','ü•á','ü•à','ü•â','üèÖ','üéñÔ∏è','üèµÔ∏è','üéóÔ∏è','üé´','üéüÔ∏è','üé™','ü§π','ü§π‚Äç‚ôÇÔ∏è','ü§π‚Äç‚ôÄÔ∏è','üé≠','ü©∞','üé®','üé¨','üé§','üéß','üéº','üéπ','ü•Å','üé∑','üé∫','ü™ó','üé∏','ü™ï','üéª','üé≤','‚ôüÔ∏è','üéØ','üé≥','üéÆ','üïπÔ∏è','üé∞','üé¥','üÉè','üÄÑ','üß©']
        };

        // Flatten emojis into categories
        for (const [category, emojis] of Object.entries(emojiCategories)) {
            const categoryDiv = document.createElement('div');
            categoryDiv.className = 'category';
            const title = document.createElement('div');
            title.className = 'category-title';
            title.textContent = category;
            categoryDiv.appendChild(title);
            emojis.forEach(emoji => {
                const emojiOption = document.createElement('div');
                emojiOption.className = 'emoji-option';
                emojiOption.textContent = emoji;
                emojiOption.draggable = true;
                emojiOption.ondragstart = dragStartPalette;
                categoryDiv.appendChild(emojiOption);
            });
            emojiPalette.appendChild(categoryDiv);
        }

        // Add Task Button
        const addTaskBtn = document.getElementById('addTaskBtn');
        addTaskBtn.onclick = () => {
            emojiPalette.classList.toggle('hidden');
        };

        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.onclick = () => {
            document.body.classList.toggle('dark-mode');
        };

        // Undo Functionality
        const undoBtn = document.getElementById('undoBtn');
        let undoStack = [];
        undoBtn.onclick = () => {
            if (undoStack.length > 0) {
                const lastAction = undoStack.pop();
                lastAction.parent.removeChild(lastAction.element);
            }
        };

        // Drag and Drop Functions
        let draggedElement = null;

        function allowDrop(ev) {
            ev.preventDefault();
        }

        function dragStartPalette(ev) {
            draggedElement = ev.target.cloneNode(true);
            ev.dataTransfer.setData('text/plain', null); // For Firefox compatibility
            setTimeout(() => {
                ev.target.classList.add('dragging');
            }, 0);
        }

        function dragStartPlanner(ev) {
            draggedElement = ev.target;
            ev.dataTransfer.setData('text/plain', null);
            setTimeout(() => {
                ev.target.classList.add('dragging');
            }, 0);
        }

        function drop(ev) {
            ev.preventDefault();
            const target = ev.currentTarget.querySelector('.emoji-container');
            if (draggedElement) {
                const emojiElement = draggedElement.cloneNode(true);
                emojiElement.classList.remove('dragging');
                emojiElement.draggable = true;
                emojiElement.ondragstart = dragStartPlanner;
                target.appendChild(emojiElement);
                undoStack.push({ parent: target, element: emojiElement });
                draggedElement = null;
            }
            const draggingElems = document.querySelectorAll('.dragging');
            draggingElems.forEach(elem => elem.classList.remove('dragging'));
        }

        // Event Listeners for Planner Emojis
        planner.addEventListener('dragover', allowDrop);
        planner.addEventListener('drop', drop);

        // Hide Emoji Palette on Outside Click
        document.addEventListener('click', function(event) {
            if (!emojiPalette.contains(event.target) && !addTaskBtn.contains(event.target)) {
                emojiPalette.classList.add('hidden');
            }
        });

        // Edge Scrolling during Dragging
        let isDragging = false;
        let scrollInterval;

        document.addEventListener('dragstart', () => {
            isDragging = true;
        });

        document.addEventListener('dragend', () => {
            isDragging = false;
            clearInterval(scrollInterval);
        });

        planner.addEventListener('dragover', (ev) => {
            ev.preventDefault();
            const plannerRect = planner.getBoundingClientRect();
            const scrollThreshold = 50; // Pixels from edge to start scrolling
            const scrollSpeed = 5; // Pixels per interval

            if (isDragging) {
                if (ev.clientY < plannerRect.top + scrollThreshold) {
                    clearInterval(scrollInterval);
                    scrollInterval = setInterval(() => {
                        planner.scrollTop -= scrollSpeed;
                    }, 20);
                } else if (ev.clientY > plannerRect.bottom - scrollThreshold) {
                    clearInterval(scrollInterval);
                    scrollInterval = setInterval(() => {
                        planner.scrollTop += scrollSpeed;
                    }, 20);
                } else {
                    clearInterval(scrollInterval);
                }
            }
        });
    </script>
</body>
</html>
